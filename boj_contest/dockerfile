# ë² ì´ìŠ¤ ì´ë¯¸ì§€ë¡œ Python 3.11 ì‚¬ìš©
FROM python:3.11

# ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì •
WORKDIR /app
# í™˜ê²½ ë³€ìˆ˜ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤
ENV PYTHONDONTWRITEBYTECODE 1
ENV PYTHONUNBUFFERED 1

# ìš”êµ¬ ì‚¬í•­ íŒŒì¼ì„ ì»¨í…Œì´ë„ˆì— ë³µì‚¬
COPY requirements.txt .

# í•„ìš” íŒ¨í‚¤ì§€ ì„¤ì¹˜
RUN pip install --upgrade pip
RUN pip install --no-cache-dir -r requirements.txt

# í”„ë¡œì íŠ¸ íŒŒì¼ì„ ì»¨í…Œì´ë„ˆì— ë³µì‚¬
COPY . /app/boj_contest

# ğŸ”¥ ë§ˆì´ê·¸ë ˆì´ì…˜ + gunicorn ì‹¤í–‰ (manageëŠ” boj_contest íŒ¨í‚¤ì§€ ì•ˆì— ìˆìŒ)
CMD ["sh", "-c", "python -m boj_contest.manage migrate --noinput && gunicorn --bind 0.0.0.0:8000 boj_contest.wsgi:application"]
